USE monitor_db;

DROP TABLE IF EXISTS hcdm_vectors_start;

CREATE TABLE hcdm_vectors_start (
	STREAM VARCHAR(100),
	START INTEGER,
	END INTEGER,
	F1 DOUBLE,
	F2 DOUBLE,
	F3 DOUBLE,
	F4 DOUBLE,
	F5 DOUBLE,
	F6 DOUBLE,
	F7 DOUBLE,
	F8 DOUBLE,
	F9 DOUBLE,
	F10 DOUBLE,
	F11 DOUBLE,
	F12 DOUBLE,
	F13 DOUBLE,
	F14 DOUBLE,
	F15 DOUBLE,
	F16 DOUBLE,
	F17 DOUBLE,
	F18 DOUBLE,
	F19 DOUBLE,
	F20 DOUBLE,
	F21 DOUBLE,
	F22 DOUBLE,
	F23 DOUBLE,
	F24 DOUBLE,
	F25 DOUBLE,
	F26 DOUBLE,
	F27 DOUBLE,
	F28 DOUBLE,
	F29 DOUBLE,
	F30 DOUBLE,
	F31 DOUBLE,
	F32 DOUBLE,
	F33 DOUBLE,
	F34 DOUBLE,
	F35 DOUBLE,
	F36 DOUBLE,
	F37 DOUBLE,
	F38 DOUBLE,
	F39 DOUBLE,
	F40 DOUBLE,
	F41 DOUBLE,
	F42 DOUBLE,
	F43 DOUBLE,
	F44 DOUBLE,
	F45 DOUBLE,
	F46 DOUBLE,
	F47 DOUBLE,
	F48 DOUBLE,
	F49 DOUBLE,
	F50 DOUBLE,
	F51 DOUBLE,
	F52 DOUBLE,
	F53 DOUBLE,
	F54 DOUBLE,
	F55 DOUBLE,
	F56 DOUBLE,
	F57 DOUBLE,
	F58 DOUBLE,
	F59 DOUBLE,
	F60 DOUBLE,
	F61 DOUBLE,
	F62 DOUBLE,
	F63 DOUBLE,
	F64 DOUBLE,
	F65 DOUBLE,
	F66 DOUBLE,
	F67 DOUBLE,
	F68 DOUBLE,
	F69 DOUBLE,
	F70 DOUBLE,
	F71 DOUBLE,
	F72 DOUBLE,
	F73 DOUBLE,
	F74 DOUBLE,
	F75 DOUBLE,
	F76 DOUBLE,
	F77 DOUBLE,
	F78 DOUBLE,
	F79 DOUBLE,
	F80 DOUBLE,
	F81 DOUBLE,
	F82 DOUBLE,
	F83 DOUBLE,
	F84 DOUBLE,
	F85 DOUBLE,
	F86 DOUBLE,
	F87 DOUBLE,
	F88 DOUBLE,
	F89 DOUBLE,
	F90 DOUBLE,
	F91 DOUBLE,
	F92 DOUBLE,
	F93 DOUBLE,
	F94 DOUBLE,
	F95 DOUBLE,
	F96 DOUBLE,
	F97 DOUBLE,
	F98 DOUBLE,
	F99 DOUBLE,
	F100 DOUBLE,
	F101 DOUBLE,
	F102 DOUBLE,
	F103 DOUBLE,
	F104 DOUBLE,
	F105 DOUBLE,
	F106 DOUBLE,
	F107 DOUBLE,
	F108 DOUBLE,
	F109 DOUBLE,
	F110 DOUBLE
);

LOAD DATA LOCAL INFILE "/Users/chengzhuduan/CSE/Research/Data-Mining-Lab/Monitor/sql/events/data/vector/hcdm_vectors.csv" INTO TABLE hcdm_vectors_start FIELDS TERMINATED BY ",";

DROP TABLE IF EXISTS hcdm_vectors;

CREATE TABLE hcdm_vectors (
	SELECT STREAM, START, END, F1, F2, F3, F4, F5, F6, F7, F8, F9, F10, F11, F12, F13, F14, F15, F16, F17, F18, F19, F20, F21, F22, F23, F24, F25, F26, F27, F28, F29, F30, F31, F32, F33, F34, F35, F36, F37, F38, F39, F40, F41, F42, F43, F44, F45, F46, F47, F48, F49, F50, F51, F52, F53, F54, F55, F56, F57, F58, F59, F60, F61, F62, F63, F64, F65, F66, F67, F68, F69, F70, F71, F72, F73, F74, F75, F76, F77, F78, F79, F80, F81, F82, F83, F84, F85, F86, F87, F88, F89, F90, F91, F92, F93, F94, F95, F96, F97, F98, F99, F100, F101, F102, F103, F104, F105, F106, F107, F108, F109, F110
	FROM hcdm_vectors_start as a, (SELECT DISTINCT name FROM stream_data) AS b
	WHERE a.stream = b.name
	UNION
	SELECT STREAM, START, END, F1, F2, F3, F4, F5, F6, F7, F8, F9, F10, F11, F12, F13, F14, F15, F16, F17, F18, F19, F20, F21, F22, F23, F24, F25, F26, F27, F28, F29, F30, F31, F32, F33, F34, F35, F36, F37, F38, F39, F40, F41, F42, F43, F44, F45, F46, F47, F48, F49, F50, F51, F52, F53, F54, F55, F56, F57, F58, F59, F60, F61, F62, F63, F64, F65, F66, F67, F68, F69, F70, F71, F72, F73, F74, F75, F76, F77, F78, F79, F80, F81, F82, F83, F84, F85, F86, F87, F88, F89, F90, F91, F92, F93, F94, F95, F96, F97, F98, F99, F100, F101, F102, F103, F104, F105, F106, F107, F108, F109, F110
	FROM hcdm_vectors_start as a, (SELECT DISTINCT stream AS title FROM aniyama) AS c
	WHERE a.stream = c.title
);

DROP TABLE hcdm_vectors_start;